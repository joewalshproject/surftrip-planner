<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Surf Finder</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #1a1a1a, #333333);
            color: #ffffff;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background-color: #0066cc;
            padding: 30px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            margin: 0;
        }
        
        .filters-section {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-label {
            font-family: 'Oswald', sans-serif;
            font-size: 16px;
            margin-bottom: 8px;
            display: block;
        }
        
        select, input[type="range"] {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .range-values {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #cccccc;
        }
        
        button {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-family: 'Oswald', sans-serif;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #0055aa;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin: 30px 0;
        }
        
        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 5px solid #0066cc;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results-section {
            display: none;
        }
        
        .results-header {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px 10px 0 0;
            margin-bottom: 2px;
        }
        
        .results-list {
            margin-top: 20px;
        }
        
        .result-card {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            transition: transform 0.2s;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .perfect-match {
            border: 2px solid #00cc66;
        }
        
        .good-match {
            border: 2px solid #ffcc00;
        }
        
        .location-info {
            flex: 1;
            min-width: 200px;
        }
        
        .location-name {
            font-family: 'Oswald', sans-serif;
            font-size: 24px;
            margin-bottom: 5px;
            color: #ffffff;
        }
        
        .location-region {
            font-size: 14px;
            color: #cccccc;
            margin-bottom: 10px;
        }
        
        .match-score {
            font-family: 'Oswald', sans-serif;
            font-size: 14px;
            padding: 3px 8px;
            border-radius: 3px;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .perfect-score {
            background-color: rgba(0, 204, 102, 0.2);
            color: #00cc66;
        }
        
        .good-score {
            background-color: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
        }
        
        .ok-score {
            background-color: rgba(255, 102, 102, 0.2);
            color: #ff6666;
        }
        
        .conditions-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            flex: 2;
            min-width: 300px;
        }
        
        .condition-box {
            flex: 1;
            min-width: 120px;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 5px;
        }
        
        .condition-label {
            font-family: 'Oswald', sans-serif;
            font-size: 14px;
            color: #0066cc;
            margin-bottom: 5px;
        }
        
        .condition-value {
            font-size: 20px;
            font-weight: 700;
        }
        
        .condition-unit {
            font-size: 14px;
            color: #cccccc;
        }
        
        .condition-detail {
            font-size: 14px;
            margin-top: 5px;
        }
        
        .good-conditions {
            color: #00cc66;
        }
        
        .fair-conditions {
            color: #ffcc00;
        }
        
        .poor-conditions {
            color: #ff6666;
        }
        
        .initial-message {
            text-align: center;
            padding: 50px 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .error-message {
            background-color: rgba(255, 0, 0, 0.2);
            color: #ff6666;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            display: none;
        }
        
        @media (max-width: 768px) {
            .filter-group {
                min-width: 100%;
            }
            
            .condition-box {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÑ‚Äç‚ôÇÔ∏è Global Surf Finder</h1>
        </div>
        
        <div class="filters-section">
            <h3>Find Your Perfect Surf Spot</h3>
            
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label">Wave Size Preference</label>
                    <select id="wave-size-min">
                        <option value="0">Any Size (Min)</option>
                        <option value="1">Ankle High+</option>
                        <option value="2">Knee High+</option>
                        <option value="3">Waist High+</option>
                        <option value="4">Chest High+</option>
                        <option value="5">Shoulder High+</option>
                        <option value="6">Head High+</option>
                        <option value="8">Overhead+</option>
                        <option value="12">Double Overhead+</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Maximum Wave Size</label>
                    <select id="wave-size-max">
                        <option value="999">Any Size (Max)</option>
                        <option value="2">Up to Knee High</option>
                        <option value="3">Up to Waist High</option>
                        <option value="4">Up to Chest High</option>
                        <option value="5">Up to Shoulder High</option>
                        <option value="6">Up to Head High</option>
                        <option value="8">Up to Overhead</option>
                        <option value="12">Up to Double Overhead</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Wind Conditions</label>
                    <select id="wind-quality">
                        <option value="any">Any Wind Conditions</option>
                        <option value="good">Offshore Only (Good)</option>
                        <option value="fair">Offshore or Cross-shore (Good/Fair)</option>
                    </select>
                </div>
            </div>
            
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label">Water Temperature (Min ¬∞F)</label>
                    <input type="range" id="water-temp-min" min="50" max="85" value="65" step="1">
                    <div class="range-values">
                        <span>50¬∞F</span>
                        <span id="water-temp-min-value">65¬∞F</span>
                        <span>85¬∞F</span>
                    </div>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Water Temperature (Max ¬∞F)</label>
                    <input type="range" id="water-temp-max" min="50" max="85" value="85" step="1">
                    <div class="range-values">
                        <span>50¬∞F</span>
                        <span id="water-temp-max-value">85¬∞F</span>
                        <span>85¬∞F</span>
                    </div>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Region</label>
                    <select id="region-filter">
                        <option value="all">All Regions</option>
                        <option value="costa-rica">Costa Rica</option>
                        <option value="portugal">Portugal</option>
                        <option value="new-zealand">New Zealand</option>
                        <option value="bali">Bali, Indonesia</option>
                        <option value="mexico">Mexico</option>
                    </select>
                </div>
            </div>
            
            <button id="find-spots">Find Surf Spots</button>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Finding your perfect surf spots...</p>
        </div>
        
        <div class="error-message" id="error-message"></div>
        
        <div class="initial-message" id="initial-message">
            <h3>Set your preferences and click "Find Surf Spots" to discover your perfect wave</h3>
            <p>This app will match you with the best surf destinations based on your preferred wave size, wind conditions, and water temperature.</p>
        </div>
        
        <div class="results-section" id="results-section">
            <div class="results-header">
                <h3>Best Matching Surf Spots</h3>
                <p id="results-count"></p>
            </div>
            
            <div class="results-list" id="results-list">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>
    
    <script>
        // Global surf spots database with realistic data
        const SURF_SPOTS = {
            // Costa Rica
            "tamarindo": {
                "name": "Tamarindo",
                "region": "Costa Rica",
                "country": "Costa Rica",
                "lat": 10.299,
                "lon": -85.839,
                "facing": 270,  // West facing
                "wave_height_ft": 4.5,
                "wave_period_s": 12,
                "water_temp_f": 80,
                "wind_speed_mph": 8,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Dec-Apr",
                "consistency": "Reliable year-round",
                "difficulty": "Beginner to Intermediate"
            },
            "nosara": {
                "name": "Nosara",
                "region": "Costa Rica",
                "country": "Costa Rica",
                "lat": 9.9767,
                "lon": -85.6825,
                "facing": 270,  // West facing
                "wave_height_ft": 5.2,
                "wave_period_s": 13,
                "water_temp_f": 79,
                "wind_speed_mph": 10,
                "wind_direction_deg": 85,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Dec-Apr",
                "consistency": "Very consistent",
                "difficulty": "Intermediate"
            },
            "santa-teresa": {
                "name": "Santa Teresa",
                "region": "Costa Rica",
                "country": "Costa Rica",
                "lat": 9.6433,
                "lon": -85.1683,
                "facing": 270,  // West facing
                "wave_height_ft": 4.8,
                "wave_period_s": 12,
                "water_temp_f": 80,
                "wind_speed_mph": 12,
                "wind_direction_deg": 120,
                "wind_type": "Cross-shore",
                "wind_quality": "Fair",
                "best_season": "Dec-Apr",
                "consistency": "Consistent",
                "difficulty": "Beginner to Advanced"
            },
            "playa-hermosa": {
                "name": "Playa Hermosa de Jaco",
                "region": "Costa Rica",
                "country": "Costa Rica",
                "lat": 9.5667,
                "lon": -84.5667,
                "facing": 225,  // Southwest facing
                "wave_height_ft": 6.5,
                "wave_period_s": 14,
                "water_temp_f": 81,
                "wind_speed_mph": 7,
                "wind_direction_deg": 45,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "May-Nov",
                "consistency": "Very consistent",
                "difficulty": "Intermediate to Advanced"
            },
            "dominical": {
                "name": "Dominical",
                "region": "Costa Rica",
                "country": "Costa Rica",
                "lat": 9.2525,
                "lon": -83.8636,
                "facing": 225,  // Southwest facing
                "wave_height_ft": 5.8,
                "wave_period_s": 13,
                "water_temp_f": 80,
                "wind_speed_mph": 15,
                "wind_direction_deg": 180,
                "wind_type": "Onshore",
                "wind_quality": "Poor",
                "best_season": "Dec-Apr",
                "consistency": "Very consistent",
                "difficulty": "Intermediate to Advanced"
            },
            "puerto-viejo": {
                "name": "Puerto Viejo",
                "region": "Costa Rica (Caribbean)",
                "country": "Costa Rica",
                "lat": 9.6589,
                "lon": -82.7545,
                "facing": 90,  // East facing
                "wave_height_ft": 3.2,
                "wave_period_s": 9,
                "water_temp_f": 82,
                "wind_speed_mph": 8,
                "wind_direction_deg": 270,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Dec-Mar",
                "consistency": "Seasonal",
                "difficulty": "Intermediate"
            },
            
            // Portugal
            "peniche": {
                "name": "Supertubos, Peniche",
                "region": "Portugal",
                "country": "Portugal",
                "lat": 39.3436,
                "lon": -9.3680,
                "facing": 270,  // West facing
                "wave_height_ft": 6.8,
                "wave_period_s": 12,
                "water_temp_f": 63,
                "wind_speed_mph": 10,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Oct-Mar",
                "consistency": "Very consistent",
                "difficulty": "Intermediate to Advanced"
            },
            "ericeira": {
                "name": "Ribeira d'Ilhas, Ericeira",
                "region": "Portugal",
                "country": "Portugal",
                "lat": 38.9914,
                "lon": -9.4215,
                "facing": 270,  // West facing
                "wave_height_ft": 5.5,
                "wave_period_s": 11,
                "water_temp_f": 62,
                "wind_speed_mph": 8,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Sep-Apr",
                "consistency": "Very consistent",
                "difficulty": "Intermediate"
            },
            "nazare": {
                "name": "Nazar√©",
                "region": "Portugal",
                "country": "Portugal",
                "lat": 39.6079,
                "lon": -9.0846,
                "facing": 270,  // West facing
                "wave_height_ft": 15.0,
                "wave_period_s": 16,
                "water_temp_f": 61,
                "wind_speed_mph": 12,
                "wind_direction_deg": 100,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Oct-Mar",
                "consistency": "Seasonal big waves",
                "difficulty": "Expert Only"
            },
            "sagres": {
                "name": "Sagres",
                "region": "Portugal",
                "country": "Portugal",
                "lat": 37.0087,
                "lon": -8.9407,
                "facing": 225,  // Southwest facing
                "wave_height_ft": 4.2,
                "wave_period_s": 10,
                "water_temp_f": 64,
                "wind_speed_mph": 15,
                "wind_direction_deg": 45,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Sep-May",
                "consistency": "Consistent",
                "difficulty": "Beginner to Intermediate"
            },
            
            // New Zealand
            "raglan": {
                "name": "Manu Bay, Raglan",
                "region": "New Zealand",
                "country": "New Zealand",
                "lat": -37.8274,
                "lon": 174.8014,
                "facing": 270,  // West facing
                "wave_height_ft": 4.8,
                "wave_period_s": 12,
                "water_temp_f": 60,
                "wind_speed_mph": 8,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Mar-Oct",
                "consistency": "Very consistent",
                "difficulty": "Intermediate"
            },
            "piha": {
                "name": "Piha Beach",
                "region": "New Zealand",
                "country": "New Zealand",
                "lat": -36.9548,
                "lon": 174.4686,
                "facing": 270,  // West facing
                "wave_height_ft": 5.5,
                "wave_period_s": 11,
                "water_temp_f": 59,
                "wind_speed_mph": 12,
                "wind_direction_deg": 100,
                "wind_type": "Cross-shore",
                "wind_quality": "Fair",
                "best_season": "Mar-Oct",
                "consistency": "Consistent",
                "difficulty": "Intermediate to Advanced"
            },
            "gisborne": {
                "name": "Gisborne",
                "region": "New Zealand",
                "country": "New Zealand",
                "lat": -38.6722,
                "lon": 178.0242,
                "facing": 90,  // East facing
                "wave_height_ft": 3.8,
                "wave_period_s": 10,
                "water_temp_f": 61,
                "wind_speed_mph": 10,
                "wind_direction_deg": 270,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Nov-Apr",
                "consistency": "Consistent",
                "difficulty": "Beginner to Intermediate"
            },
            "dunedin": {
                "name": "St Clair, Dunedin",
                "region": "New Zealand",
                "country": "New Zealand",
                "lat": -45.9132,
                "lon": 170.4900,
                "facing": 135,  // Southeast facing
                "wave_height_ft": 4.2,
                "wave_period_s": 11,
                "water_temp_f": 52,
                "wind_speed_mph": 15,
                "wind_direction_deg": 315,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Apr-Oct",
                "consistency": "Consistent",
                "difficulty": "Intermediate"
            },
            
            // Bali, Indonesia
            "uluwatu": {
                "name": "Uluwatu",
                "region": "Bali, Indonesia",
                "country": "Indonesia",
                "lat": -8.8295,
                "lon": 115.0849,
                "facing": 225,  // Southwest facing
                "wave_height_ft": 6.5,
                "wave_period_s": 14,
                "water_temp_f": 82,
                "wind_speed_mph": 8,
                "wind_direction_deg": 45,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "May-Sep",
                "consistency": "Very consistent",
                "difficulty": "Intermediate to Advanced"
            },
            "padang-padang": {
                "name": "Padang Padang",
                "region": "Bali, Indonesia",
                "country": "Indonesia",
                "lat": -8.8106,
                "lon": 115.0931,
                "facing": 225,  // Southwest facing
                "wave_height_ft": 5.8,
                "wave_period_s": 14,
                "water_temp_f": 82,
                "wind_speed_mph": 7,
                "wind_direction_deg": 45,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Jun-Sep",
                "consistency": "Needs good swell",
                "difficulty": "Advanced"
            },
            "canggu": {
                "name": "Canggu",
                "region": "Bali, Indonesia",
                "country": "Indonesia",
                "lat": -8.6478,
                "lon": 115.1385,
                "facing": 270,  // West facing
                "wave_height_ft": 3.5,
                "wave_period_s": 11,
                "water_temp_f": 83,
                "wind_speed_mph": 10,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "May-Sep",
                "consistency": "Very consistent",
                "difficulty": "Beginner to Intermediate"
            },
            "keramas": {
                "name": "Keramas",
                "region": "Bali, Indonesia",
                "country": "Indonesia",
                "lat": -8.6131,
                "lon": 115.3366,
                "facing": 135,  // Southeast facing
                "wave_height_ft": 4.8,
                "wave_period_s": 12,
                "water_temp_f": 83,
                "wind_speed_mph": 12,
                "wind_direction_deg": 315,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Nov-Mar",
                "consistency": "Consistent",
                "difficulty": "Intermediate to Advanced"
            },
            
            // Mexico
            "puerto-escondido": {
                "name": "Zicatela, Puerto Escondido",
                "region": "Mexico",
                "country": "Mexico",
                "lat": 15.8619,
                "lon": -97.0532,
                "facing": 180,  // South facing
                "wave_height_ft": 8.5,
                "wave_period_s": 15,
                "water_temp_f": 82,
                "wind_speed_mph": 8,
                "wind_direction_deg": 0,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "May-Oct",
                "consistency": "Very consistent",
                "difficulty": "Advanced to Expert"
            },
            "sayulita": {
                "name": "Sayulita",
                "region": "Mexico",
                "country": "Mexico",
                "lat": 20.8699,
                "lon": -105.4413,
                "facing": 270,  // West facing
                "wave_height_ft": 3.2,
                "wave_period_s": 10,
                "water_temp_f": 79,
                "wind_speed_mph": 10,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Nov-Apr",
                "consistency": "Consistent",
                "difficulty": "Beginner"
            },
            "todos-santos": {
                "name": "Todos Santos",
                "region": "Mexico",
                "country": "Mexico",
                "lat": 23.4478,
                "lon": -110.2265,
                "facing": 270,  // West facing
                "wave_height_ft": 5.5,
                "wave_period_s": 12,
                "water_temp_f": 72,
                "wind_speed_mph": 12,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Nov-Mar",
                "consistency": "Consistent",
                "difficulty": "Intermediate"
            },
            "punta-mita": {
                "name": "Punta de Mita",
                "region": "Mexico",
                "country": "Mexico",
                "lat": 20.7732,
                "lon": -105.5313,
                "facing": 270,  // West facing
                "wave_height_ft": 4.2,
                "wave_period_s": 11,
                "water_temp_f": 80,
                "wind_speed_mph": 8,
                "wind_direction_deg": 90,
                "wind_type": "Offshore",
                "wind_quality": "Good",
                "best_season": "Nov-Apr",
                "consistency": "Consistent",
                "difficulty": "Beginner to Intermediate"
            }
        };

        // Function to convert wave height to surfer-friendly terms
        function classifyWaveHeight(heightFeet) {
            if (heightFeet < 2) {
                return "Ankle to knee high";
            } else if (heightFeet < 3) {
                return "Knee to thigh high";
            } else if (heightFeet < 4) {
                return "Waist high";
            } else if (heightFeet < 5) {
                return "Chest high";
            } else if (heightFeet < 6) {
                return "Shoulder high";
            } else if (heightFeet < 8) {
                return "Head high";
            } else if (heightFeet < 12) {
                return "Overhead";
            } else {
                return "Double overhead+";
            }
        }

        // Function to get cardinal direction
        function getCardinalDirection(degrees) {
            const directions = ["N", "NNE", "NE", "ENE", "E", "ESE", "SE", "SSE", 
                              "S", "SSW", "SW", "WSW", "W", "WNW", "NW", "NNW"];
            const index = Math.round(degrees / 22.5) % 16;
            return directions[index];
        }

        // Function to calculate match score based on user preferences
        function calculateMatchScore(spot, preferences) {
            let score = 0;
            let maxScore = 0;
            let reasons = [];
            
            // Wave height match (0-40 points)
            maxScore += 40;
            if (spot.wave_height_ft >= preferences.waveMinFt && spot.wave_height_ft <= preferences.waveMaxFt) {
                // Perfect wave height match
                score += 40;
            } else if (spot.wave_height_ft >= preferences.waveMinFt * 0.8 && spot.wave_height_ft <= preferences.waveMaxFt * 1.2) {
                // Close to preferred range
                score += 25;
                reasons.push("Wave height slightly outside preferred range");
            } else {
                // Not in preferred range
                score += 0;
                reasons.push("Wave height outside preferred range");
            }
            
            // Wind quality match (0-30 points)
            maxScore += 30;
            if (preferences.windQuality === "any" || 
                (preferences.windQuality === "good" && spot.wind_quality === "Good") ||
                (preferences.windQuality === "fair" && (spot.wind_quality === "Good" || spot.wind_quality === "Fair"))) {
                // Perfect wind match
                score += 30;
            } else if (spot.wind_quality === "Fair" && preferences.windQuality === "good") {
                // Fair wind when preferred good
                score += 15;
                reasons.push("Cross-shore winds (fair) when offshore (good) preferred");
            } else {
                // Poor wind
                score += 0;
                reasons.push("Wind conditions don't match preference");
            }
            
            // Water temperature match (0-30 points)
            maxScore += 30;
            if (spot.water_temp_f >= preferences.waterTempMinF && spot.water_temp_f <= preferences.waterTempMaxF) {
                // Perfect temperature match
                score += 30;
            } else if (spot.water_temp_f >= preferences.waterTempMinF - 5 && spot.water_temp_f <= preferences.waterTempMaxF + 5) {
                // Close to preferred range
                score += 15;
                reasons.push("Water temperature slightly outside preferred range");
            } else {
                // Not in preferred range
                score += 0;
                reasons.push("Water temperature outside preferred range");
            }
            
            // Calculate percentage score
            const percentageScore = Math.round((score / maxScore) * 100);
            
            return {
                score: percentageScore,
                reasons: reasons
            };
        }

        // Function to find matching surf spots based on user preferences
        function findMatchingSurfSpots(preferences) {
            const matches = [];
            
            // Loop through all surf spots
            for (const spotId in SURF_SPOTS) {
                const spot = SURF_SPOTS[spotId];
                
                // Skip if region filter is applied and doesn't match
                if (preferences.region !== "all" && !spot.region.toLowerCase().includes(preferences.region)) {
                    continue;
                }
                
                // Calculate match score
                const matchResult = calculateMatchScore(spot, preferences);
                
                // Add to matches if score is above threshold
                if (matchResult.score > 0) {
                    matches.push({
                        id: spotId,
                        spot: spot,
                        score: matchResult.score,
                        reasons: matchResult.reasons
                    });
                }
            }
            
            // Sort matches by score (highest first)
            matches.sort((a, b) => b.score - a.score);
            
            return matches;
        }

        // Function to create result card HTML
        function createResultCard(match) {
            const spot = match.spot;
            const score = match.score;
            
            // Determine match class
            let matchClass = "";
            let scoreClass = "";
            if (score >= 90) {
                matchClass = "perfect-match";
                scoreClass = "perfect-score";
            } else if (score >= 70) {
                matchClass = "good-match";
                scoreClass = "good-score";
            } else {
                scoreClass = "ok-score";
            }
            
            // Determine wind quality class
            let windClass = "";
            if (spot.wind_quality === "Good") {
                windClass = "good-conditions";
            } else if (spot.wind_quality === "Fair") {
                windClass = "fair-conditions";
            } else {
                windClass = "poor-conditions";
            }
            
            // Create HTML
            return `
                <div class="result-card ${matchClass}">
                    <div class="location-info">
                        <div class="location-name">${spot.name}</div>
                        <div class="location-region">${spot.region}</div>
                        <div class="match-score ${scoreClass}">${score}% Match</div>
                        <div class="condition-detail">Best Season: ${spot.best_season}</div>
                        <div class="condition-detail">Consistency: ${spot.consistency}</div>
                        <div class="condition-detail">Difficulty: ${spot.difficulty}</div>
                    </div>
                    <div class="conditions-grid">
                        <div class="condition-box">
                            <div class="condition-label">Wave Height</div>
                            <div class="condition-value">${spot.wave_height_ft} <span class="condition-unit">ft</span></div>
                            <div class="condition-detail">${classifyWaveHeight(spot.wave_height_ft)}</div>
                        </div>
                        <div class="condition-box">
                            <div class="condition-label">Wave Period</div>
                            <div class="condition-value">${spot.wave_period_s} <span class="condition-unit">sec</span></div>
                        </div>
                        <div class="condition-box">
                            <div class="condition-label">Water Temp</div>
                            <div class="condition-value">${spot.water_temp_f}¬∞ <span class="condition-unit">F</span></div>
                        </div>
                        <div class="condition-box">
                            <div class="condition-label">Wind</div>
                            <div class="condition-value">${spot.wind_speed_mph} <span class="condition-unit">mph</span></div>
                            <div class="condition-detail ${windClass}">${spot.wind_type} (${spot.wind_quality})</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Function to update the UI with results
        function updateResultsUI(matches) {
            const resultsSection = document.getElementById('results-section');
            const initialMessage = document.getElementById('initial-message');
            const resultsList = document.getElementById('results-list');
            const resultsCount = document.getElementById('results-count');
            
            // Hide loading spinner and initial message
            document.getElementById('loading').style.display = 'none';
            initialMessage.style.display = 'none';
            
            // Show results section
            resultsSection.style.display = 'block';
            
            // Update results count
            resultsCount.textContent = `Found ${matches.length} matching surf spots`;
            
            // Clear previous results
            resultsList.innerHTML = '';
            
            // Add result cards
            if (matches.length > 0) {
                matches.forEach(match => {
                    resultsList.innerHTML += createResultCard(match);
                });
            } else {
                resultsList.innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <h3>No matching surf spots found</h3>
                        <p>Try adjusting your preferences to see more results.</p>
                    </div>
                `;
            }
        }

        // Function to handle the find spots button click
        function findSpots() {
            // Get user preferences
            const waveMinFt = parseFloat(document.getElementById('wave-size-min').value);
            const waveMaxFt = parseFloat(document.getElementById('wave-size-max').value);
            const windQuality = document.getElementById('wind-quality').value;
            const waterTempMinF = parseInt(document.getElementById('water-temp-min').value);
            const waterTempMaxF = parseInt(document.getElementById('water-temp-max').value);
            const region = document.getElementById('region-filter').value;
            
            // Create preferences object
            const preferences = {
                waveMinFt: waveMinFt,
                waveMaxFt: waveMaxFt,
                windQuality: windQuality,
                waterTempMinF: waterTempMinF,
                waterTempMaxF: waterTempMaxF,
                region: region
            };
            
            // Show loading spinner
            document.getElementById('loading').style.display = 'block';
            document.getElementById('initial-message').style.display = 'none';
            document.getElementById('results-section').style.display = 'none';
            document.getElementById('error-message').style.display = 'none';
            
            // Simulate loading delay for realism
            setTimeout(() => {
                try {
                    // Find matching surf spots
                    const matches = findMatchingSurfSpots(preferences);
                    
                    // Update the UI
                    updateResultsUI(matches);
                } catch (error) {
                    console.error('Error finding spots:', error);
                    
                    // Show error message
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('results-section').style.display = 'none';
                    document.getElementById('error-message').style.display = 'block';
                    document.getElementById('error-message').textContent = 'Error finding surf spots: ' + error.message;
                }
            }, 1500);
        }

        // Initialize range sliders
        function initRangeSliders() {
            const waterTempMin = document.getElementById('water-temp-min');
            const waterTempMinValue = document.getElementById('water-temp-min-value');
            const waterTempMax = document.getElementById('water-temp-max');
            const waterTempMaxValue = document.getElementById('water-temp-max-value');
            
            // Update min temp value display
            waterTempMin.addEventListener('input', function() {
                waterTempMinValue.textContent = this.value + '¬∞F';
                
                // Ensure min doesn't exceed max
                if (parseInt(this.value) > parseInt(waterTempMax.value)) {
                    waterTempMax.value = this.value;
                    waterTempMaxValue.textContent = this.value + '¬∞F';
                }
            });
            
            // Update max temp value display
            waterTempMax.addEventListener('input', function() {
                waterTempMaxValue.textContent = this.value + '¬∞F';
                
                // Ensure max doesn't go below min
                if (parseInt(this.value) < parseInt(waterTempMin.value)) {
                    waterTempMin.value = this.value;
                    waterTempMinValue.textContent = this.value + '¬∞F';
                }
            });
            
            // Initialize displays
            waterTempMinValue.textContent = waterTempMin.value + '¬∞F';
            waterTempMaxValue.textContent = waterTempMax.value + '¬∞F';
        }

        // Add event listener to the find spots button
        document.getElementById('find-spots').addEventListener('click', findSpots);
        
        // Initialize range sliders on page load
        document.addEventListener('DOMContentLoaded', initRangeSliders);
    </script>
</body>
</html>
