<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Costa Rica Surf Conditions</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f8ff;
            padding-top: 20px;
        }
        .header {
            background-color: #0275d8;
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            border-radius: 5px;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            font-weight: bold;
        }
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .spinner-border {
            width: 3rem;
            height: 3rem;
        }
        .wave-classification {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            margin-top: 10px;
        }
        .ankle, .knee {
            background-color: #d4edda;
            color: #155724;
        }
        .waist, .shoulder {
            background-color: #fff3cd;
            color: #856404;
        }
        .head, .overhead {
            background-color: #f8d7da;
            color: #721c24;
        }
        .double-overhead {
            background-color: #721c24;
            color: white;
        }
        .wind-good {
            background-color: #d4edda;
            color: #155724;
        }
        .wind-fair {
            background-color: #fff3cd;
            color: #856404;
        }
        .wind-poor {
            background-color: #f8d7da;
            color: #721c24;
        }
        footer {
            margin-top: 50px;
            padding: 20px 0;
            background-color: #f8f9fa;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
            <h1>Costa Rica Surf Conditions</h1>
            <p class="lead">Check current surf conditions at popular Costa Rican surf spots</p>
        </div>

        <div class="row mb-4">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        Select Location
                    </div>
                    <div class="card-body">
                        <select id="location-select" class="form-select mb-3">
                            <option value="" selected disabled>Choose a surf spot</option>
                            <option value="tamarindo">Tamarindo</option>
                            <option value="nosara">Nosara</option>
                            <option value="playa-hermosa">Playa Hermosa de Jaco</option>
                            <option value="santa-teresa">Santa Teresa</option>
                            <option value="dominical">Dominical</option>
                            <option value="puerto-viejo">Puerto Viejo</option>
                        </select>
                        <button id="check-conditions" class="btn btn-primary w-100">Check Surf Conditions</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="loading" class="loading">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p>Fetching surf conditions...</p>
        </div>

        <div id="results" class="row" style="display: none;">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        Wave Information
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <h5>Wave Height:</h5>
                            <span id="wave-height" class="fw-bold">--</span>
                        </div>
                        <div id="wave-classification-container">
                            <span id="wave-classification" class="wave-classification">--</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <h5>Wave Period:</h5>
                            <span id="wave-period" class="fw-bold">--</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <h5>Wave Direction:</h5>
                            <span id="wave-direction" class="fw-bold">--</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        Water & Wind Information
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <h5>Water Temperature:</h5>
                            <span id="water-temp" class="fw-bold">--</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <h5>Wind Direction:</h5>
                            <span id="wind-direction" class="fw-bold">--</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <h5>Wind Speed:</h5>
                            <span id="wind-speed" class="fw-bold">--</span>
                        </div>
                        <hr>
                        <div id="wind-quality-container" class="mt-2">
                            <span id="wind-quality" class="wave-classification">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="error-message" class="alert alert-danger mt-4" style="display: none;">
            <strong>Error:</strong> <span id="error-text"></span>
            <p>There was a problem connecting to the Open-Meteo API. Please try again later.</p>
        </div>
    </div>

    <!-- Removed footer as requested by user -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Costa Rica surf locations with coordinates
        const locations = {
            "tamarindo": { name: "Tamarindo", lat: 10.2992, lon: -85.8371 },
            "nosara": { name: "Nosara", lat: 9.9765, lon: -85.6532 },
            "playa-hermosa": { name: "Playa Hermosa de Jaco", lat: 9.5664, lon: -84.5765 },
            "santa-teresa": { name: "Santa Teresa", lat: 9.6433, lon: -85.1683 },
            "dominical": { name: "Dominical", lat: 9.2525, lon: -83.8599 },
            "puerto-viejo": { name: "Puerto Viejo", lat: 9.6589, lon: -82.7545 }
        };

        // Wave height classification
        function classifyWaveHeight(height) {
            if (height < 0.5) return { text: "Ankle high", class: "ankle" };
            if (height < 0.8) return { text: "Knee high", class: "knee" };
            if (height < 1.0) return { text: "Waist high", class: "waist" };
            if (height < 1.5) return { text: "Shoulder high", class: "shoulder" };
            if (height < 2.0) return { text: "Head high", class: "head" };
            if (height < 3.0) return { text: "Overhead", class: "overhead" };
            return { text: "Double overhead+", class: "double-overhead" };
        }

        // Wind quality assessment
        function assessWindQuality(speed) {
            if (speed < 10) return { text: "Light winds - Good for surfing!", class: "wind-good" };
            if (speed < 20) return { text: "Moderate winds - Fair conditions", class: "wind-fair" };
            return { text: "Strong winds - Challenging conditions", class: "wind-poor" };
        }

        // Convert degrees to cardinal direction
        function degreesToCardinal(degrees) {
            const directions = ["N", "NE", "E", "SE", "S", "SW", "W", "NW", "N"];
            const index = Math.round(degrees / 45);
            return directions[index];
        }

        // Display surf conditions
        function displaySurfConditions(locationId, data) {
            // Wave information
            document.getElementById('wave-height').textContent = `${data.wave_height.toFixed(1)}m`;
            
            const waveClass = classifyWaveHeight(data.wave_height);
            const waveClassElement = document.getElementById('wave-classification');
            waveClassElement.textContent = waveClass.text;
            waveClassElement.className = `wave-classification ${waveClass.class}`;
            
            document.getElementById('wave-period').textContent = `${data.wave_period.toFixed(1)}s`;
            
            const waveCardinal = degreesToCardinal(data.wave_direction);
            document.getElementById('wave-direction').textContent = `${waveCardinal} (${data.wave_direction}°)`;
            
            // Water and wind information
            document.getElementById('water-temp').textContent = `${data.water_temp.toFixed(1)}°C`;
            
            const windCardinal = degreesToCardinal(data.wind_direction);
            document.getElementById('wind-direction').textContent = `${windCardinal} (${data.wind_direction}°)`;
            
            document.getElementById('wind-speed').textContent = `${data.wind_speed} km/h`;
            
            const windQuality = assessWindQuality(data.wind_speed);
            const windQualityElement = document.getElementById('wind-quality');
            windQualityElement.textContent = windQuality.text;
            windQualityElement.className = `wave-classification ${windQuality.class}`;
            
            // Show results
            document.getElementById('loading').style.display = 'none';
            document.getElementById('results').style.display = 'flex';
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const checkButton = document.getElementById('check-conditions');
            const locationSelect = document.getElementById('location-select');
            
            checkButton.addEventListener('click', function() {
                const locationId = locationSelect.value;
                
                if (!locationId) {
                    alert('Please select a surf spot');
                    return;
                }
                
                const location = locations[locationId];
                
                // Show loading indicator
                document.getElementById('results').style.display = 'none';
                document.getElementById('error-message').style.display = 'none';
                document.getElementById('loading').style.display = 'block';
                
                // Call the Open-Meteo Marine API
                fetchSurfConditions(location.lat, location.lon, locationId);
            });
            
            // Function to fetch data from Open-Meteo API
            async function fetchSurfConditions(lat, lon, locationId) {
                try {
                    // Construct the API URL
                    const apiUrl = `https://marine-api.open-meteo.com/v1/marine?latitude=${lat}&longitude=${lon}&hourly=wave_height,wave_direction,wave_period,sea_surface_temperature&current_weather=true`;
                    
                    // Fetch data from API
                    const response = await fetch(apiUrl);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // Process the data
                    const currentHour = new Date().getHours();
                    
                    // Create conditions object with default values
                    const conditions = {
                        wave_height: data.hourly.wave_height[currentHour] || 1.0,
                        wave_direction: data.hourly.wave_direction[currentHour] || 180,
                        wave_period: data.hourly.wave_period[currentHour] || 10,
                        water_temp: data.hourly.sea_surface_temperature[currentHour] || 26,
                        wind_speed: 10,
                        wind_direction: 180
                    };
                    
                    // Add wind data if available
                    if (data.current_weather) {
                        conditions.wind_speed = data.current_weather.windspeed || 10;
                        conditions.wind_direction = data.current_weather.winddirection || 180;
                    }
                    
                    // Display the conditions
                    displaySurfConditions(locationId, conditions);
                    
                } catch (error) {
                    console.error('Error fetching surf conditions:', error);
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('error-text').textContent = `${error.message}`;
                    document.getElementById('error-message').style.display = 'block';
                }
            }
        });
    </script>
</body>
</html>
